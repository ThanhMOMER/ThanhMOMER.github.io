<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B·∫£ng Pha Th·ªùi Gian</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px;
            /* Th√™m margin cho body */
            padding: 10px;
            background-color: #f0f0f0;
        }

        #canvasContainer {
            width: 100%;
            max-width: 960px;
        }

        canvas {
            width: 100%;
            height: auto;
            border: 1px solid black;
            display: block;
        }
    </style>
</head>

<body>
    <div id="canvasContainer">
        <canvas id="timeCanvas" width="3840" height="2160"></canvas>
    </div>
    <script>
        // Thi·∫øt l·∫≠p m√∫i gi·ªù v√† th·ªùi gian hi·ªán t·∫°i
        // const vn_tz = "Asia/Ho_Chi_Minh";
        // const now = new Date('2025-05-29T10:28:00+07:00');
        const now = new Date(new Date().toLocaleString("en-US", { timeZone: "Asia/Ho_Chi_Minh" }));


        // K√≠ch th∆∞·ªõc canvas
        const img_width = 3840;
        const img_height = 2160;
        /// const - Th√™m margin 4 b√™n
        const margin = 250; // Margin 50px cho 4 b√™n
        const gap = 100;
        const section_height = Math.floor((img_height - margin * 2 - 7 * gap) / 8);

        const section_positions = Array.from({ length: 8 }, (_, i) => margin + i * (section_height + gap));

        const total_height = section_positions[7] + section_height;

        // L·∫•y canvas v√† context
        const canvas = document.getElementById("timeCanvas");
        const ctx = canvas.getContext("2d");

        // M√†u s·∫Øc v√† nh√£n
        const colors = ["#b3e5fc", "#c8e6c9", "#fff9c4", "#ffcdd2"];
        const labels = ["1", "2", "3", "4"];

        // H√†m ƒë·ªãnh d·∫°ng ng√†y gi·ªù
        function formatDateTime(date) {
            return `${date.getDate().toString().padStart(2, "0")}/${(date.getMonth() + 1).toString().padStart(2, "0")} ${date.getHours().toString().padStart(2, "0")}:${date.getMinutes().toString().padStart(2, "0")}`;
        }

        // H√†m v·∫Ω bi·ªÉu t∆∞·ª£ng l·ªãch
        function drawCalendarIcon(x, y) {
            ctx.fillStyle = "#2196F3";
            ctx.fillRect(x, y, 30, 30);
            ctx.fillStyle = "white";
            ctx.font = "bold 20px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText("üìÖ", x + 15, y + 15);
        }

        // H√†m v·∫Ω t·ª´ng khung
        function drawTimeSection(y_px, start_time, end_time, colors, sublabels, title, prefix = "") {
            const y = y_px / total_height * (img_height - margin * 2) + margin;
            const h = section_height / total_height * (img_height - margin * 2);

            // V·∫Ω 4 ph·∫ßn ch√≠nh
            for (let i = 0; i < 4; i++) {
                const x0 = margin + (i / 4) * (img_width - margin * 2);
                ctx.fillStyle = colors[i];
                ctx.strokeStyle = "gray";
                ctx.fillRect(x0, y, (img_width - margin * 2) / 4, h);
                ctx.strokeRect(x0, y, (img_width - margin * 2) / 4, h);

                // V·∫Ω 4 ph·∫ßn con ch·ªâ b·∫±ng ƒë∆∞·ªùng k·∫ª
                ctx.strokeStyle = "#555"; // M√†u x√°m cho ph·∫ßn con
                ctx.lineWidth = 2;
                for (let j = 1; j < 4; j++) {
                    const sub_x = x0 + j * ((img_width - margin * 2) / 4) / 4;
                    ctx.beginPath();
                    ctx.moveTo(sub_x, y);
                    ctx.lineTo(sub_x, y + h);
                    ctx.stroke();
}


                // V·∫Ω nh√£n con
                ctx.fillStyle = "black";
                ctx.font = "bold 42px Arial";
                ctx.textAlign = "center";
                ctx.textBaseline = "middle";
                ctx.fillText(sublabels[i], x0 + (img_width - margin * 2) / 8, y + h / 2);
            }

            // V·∫°ch "Now"
            const total_sec = (end_time - start_time) / 1000;
            const elapsed_sec = (now - start_time) / 1000;
            const now_pos = margin + Math.max(0, Math.min(1, elapsed_sec / total_sec)) * (img_width - margin * 2);
            ctx.strokeStyle = "red";
            ctx.lineWidth = 6;
            ctx.setLineDash([10, 10]);
            ctx.beginPath();
            ctx.moveTo(now_pos, y);
            ctx.lineTo(now_pos, y + h);
            ctx.stroke();
            ctx.setLineDash([]);

            // M·ªëc chia ch√≠nh
            ctx.fillStyle = "black";
            ctx.font = "bold 24px Arial";
            ctx.textAlign = "center";
            for (let i = 0; i < 5; i++) {
                const frac = i / 4;
                const time_point = new Date(start_time.getTime() + total_sec * frac * 1000);
                const label = formatDateTime(time_point);
                ctx.fillText(label, margin + frac * (img_width - margin * 2), y - 36);
            }

            // // T√™n khung
            // ctx.fillStyle = "black";
            // ctx.font = "bold 39px Arial";
            // ctx.textAlign = "left";
            // ctx.textBaseline = "middle";
            // ctx.fillText(title, margin + 60, y + h / 2 - 10);
            // T√™n khung
            ctx.fillStyle = "black";
            ctx.font = "bold 39px Arial";
            ctx.textAlign = "left";
            ctx.textBaseline = "middle";
            ctx.fillText(title, margin + 260, y - 35); // Ch·ªânh x th√†nh margin, y d·ªãch l√™n tr√™n
        }

        // H√†m ch√≠nh ƒë·ªÉ v·∫Ω
        function drawTimeline() {
            ctx.clearRect(0, 0, img_width, img_height);
            ctx.fillStyle = "white";
            ctx.fillRect(0, 0, img_width, img_height);

            // Ti√™u ƒë·ªÅ
            ctx.fillStyle = "red";
            ctx.font = "bold 60px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "top";
            ctx.fillText("B·∫¢NG PHA TH·ªúI GIAN", img_width / 2, margin);

            // C·∫•p 1Y
            let start_y = new Date(now.getFullYear(), 0, 1, 7);
            let end_y = new Date(start_y.getFullYear() + 1, 0, 1, 7);
            drawTimeSection(section_positions[0], start_y, end_y, colors, labels, "C·∫•p 1Y");


            // C·∫•p 6M   
            let month6 = Math.floor(now.getMonth() / 6) * 6;
            let start_6m = new Date(now.getFullYear(), month6, 1, 7);
            let end_6m = new Date(start_6m.getFullYear(), start_6m.getMonth() + 6, 1, 7);
            drawTimeSection(section_positions[1], start_6m, end_6m, colors, labels, "C·∫•p 6M");



            // C·∫•p 3M
            let month3 = Math.floor(now.getMonth() / 3) * 3;
            let start_3m = new Date(now.getFullYear(), month3, 1, 7);
            let end_3m = new Date(start_3m.getFullYear(), start_3m.getMonth() + 3, 1, 7);
            drawTimeSection(section_positions[2], start_3m, end_3m, colors, labels, "C·∫•p 3M");




            // C·∫•p 1M
            let start_1m = new Date(now.getFullYear(), now.getMonth(), 1, 7);
            let end_1m = new Date(start_1m.getFullYear(), start_1m.getMonth() + 1, 1, 7);
            drawTimeSection(section_positions[3], start_1m, end_1m, colors, labels, "C·∫•p 1M");


            // C·∫•p W
            let weekday = now.getDay() === 0 ? 7 : now.getDay(); // CN = 0 -> 7
            let start_w = new Date(now);
            start_w.setDate(now.getDate() - weekday + 1);
            start_w.setHours(7, 0, 0, 0);
            let end_w = new Date(start_w);
            end_w.setDate(start_w.getDate() + 7);
            drawTimeSection(section_positions[4], start_w, end_w, colors, labels, "C·∫•p 1W");


            // 1 D
            let start_d = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 7, 0, 0);
            let end_d = new Date(start_d.getTime() + 24 * 60 * 60 * 1000);
            drawTimeSection(section_positions[5], start_d, end_d, colors, labels, "C·∫•p 1D");



            // 12H
            let hour12 = now.getHours() < 12 ? 0 : 12;
            let start_12h = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hour12, 0, 0);
            let end_12h = new Date(start_12h.getTime() + 12 * 60 * 60 * 1000);
            drawTimeSection(section_positions[6], start_12h, end_12h, colors, labels, "C·∫•p 12H");


            // 6h
            let hour6 = Math.floor(now.getHours() / 6) * 6;
            let start_6h = new Date(now.getFullYear(), now.getMonth(), now.getDate(), hour6, 0, 0);
            let end_6h = new Date(start_6h.getTime() + 6 * 60 * 60 * 1000);
            drawTimeSection(section_positions[7], start_6h, end_6h, colors, labels, "C·∫•p 6H");




            // Ghi th·ªùi gian hi·ªán t·∫°i
            const current_time_str = `B√¢y gi·ªù l√†: ${formatDateTime(now)}:${now.getSeconds().toString().padStart(2, "0")}`;
            ctx.fillStyle = "black";
            ctx.font = "bold 44px Arial";
            ctx.textAlign = "center";
            ctx.textBaseline = "bottom";
            // ctx.fillText(current_time_str, img_width / 2, img_height - margin);
            ctx.fillText(current_time_str, img_width / 2, img_height - 1/2*margin);
        }

        // V·∫Ω bi·ªÉu ƒë·ªì
        drawTimeline();
    </script>
</body>

</html>